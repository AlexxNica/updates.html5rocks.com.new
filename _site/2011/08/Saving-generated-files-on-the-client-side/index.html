<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta property="twitter:account_id" content="1593210261" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="A resource for developers looking to put HTML5 to use today, including information on specific features and when to use them in your apps.">
<meta name="keywords" content="html5,html 5,html5 demos,html5 examples,javascript,css3,notifications,geolocation,web workers,apppcache,file api,filereader,indexeddb,offline,audio,video,drag and drop,chrome,sse,mobile">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="E1HOIDkksrWY5npenL8FeQhKn4Ujctd75iO2lfufSyA" />
<title>Saving generated files on the client-side</title>

<!-- Add to homescreen for Chrome on Android -->
<meta name="mobile-web-app-capable" content="yes">
<link rel="icon" sizes="192x192" href="  /assets/HTML5_Badge_192-f9389f6cad587f357d82be791970c8ad.png">
<meta name="theme-color" content="#3372DF">

<!-- Add to homescreen for Safari on iOS -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="HTML5 Rocks">
<link rel="apple-touch-icon-precomposed" href="/assets/HTML5_Badge_192-f9389f6cad587f357d82be791970c8ad.png
">

<!-- Tile icon for Win8 (144x144 + tile color) -->
<meta name="msapplication-TileImage" content="/assets/HTML5_Badge_144-ddcf1cea1a1204b1733041733d66f76a.png
">
<meta name="msapplication-TileColor" content="#3372DF">

<!-- TODO: consider rel=canonical -->
<link rel="alternate" type="application/rss+xml" title="HTML5 Rocks RSS" href="http://feeds.feedburner.com/html5rocks">
<link rel="publisher" href="https://plus.google.com/+GoogleChromeDevelopers">

  
    
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@ChromiumDev">
<meta name="twitter:creator" content="@sephr">

<meta property="og:type" content="article">
<meta property="og:title" content="Saving generated files on the client-side - HTML5 Rocks">
<meta property="og:url" content="/2011/08/Saving-generated-files-on-the-client-side">
<meta property="og:description" content="">
<meta property="og:image" content="http://www.html5rocks.com/static/images/profiles/eligrey.png">
<meta property="og:site_name" content="HTML5 Rocks - A resource for open web HTML5 developers">

<link rel="author" href="https://www.google.com/profiles/111217788892362755679">
  

<link href="//fonts.googleapis.com/css?family=Open+Sans:600,800|Source+Code+Pro" rel="stylesheet">
<link rel="stylesheet" href="/assets/main-8dae1b06ec239bb8b24c3d98cd1ad04b.css">

<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5-els.js"></script>
<![endif]-->

  </head>
  <body>
    <header class="main" id="siteheader">
  <a href="#sitenav" id="navtoggle"></a>
  <nav id="sitenav" class="container">
    <ul>
      <li id="tutorials_menu">
        <a href="http://www.html5rocks.com" class="tutorials">Home</a>
      </li>
      <li id="tutorials_menu">
        <a href="http://www.html5rocks.com/en/tutorials/?page=1" class="tutorials">Tutorials</a>
      </li>
      <li id="updates_menu">
        <a href="http://www.html5rocks.com/en/updates" class="updates">Updates</a>
      </li>
      <li id="contrib_menu">
        <a href="https://github.com/html5rocks/www.html5rocks.com/blob/master/CONTRIBUTING.md" target="_blank">Contribute</a>
      </li>
      <li id="slides_menu">
        <a href="http://www.html5rocks.com/en/slides" class="slides">Slides</a>
      </li>
      <li id="resources_menu">
        <a href="http://www.html5rocks.com/en/resources" class="resources">Resources</a>
      </li>
    </ul>
  </nav>
</header>

    <div class="body-content">
      <section class="banner">
        <section class="container">
          <a href="/" class="watermark"></a>
          <h1>Saving generated files on the client-side</h1>
          
        </section>
      </section>
      <article class="content-wrapper article">
<div class="container">
  <section class="byline clearfix">
    <section class="author-images">
      
        
<!-- TODO: change image address.-->

<img src="http://www.html5rocks.com/static/images/profiles/eligrey.png"
     alt="Eli Grey"
     title="Eli Grey"
     width="60" height="60"
     class="avatar">



      
    </section>
    <section class="meta">
      <div class="authors">
          
    
    <!-- TODO: change link. -->
    <strong>By</strong> <a href="http://www.html5rocks.com/profiles/#eligrey">
      Eli Grey
    </a> 
  

      </div>
      <div class="published">
        <time pubdate=""><strong>Published:</strong> August 08, 2011</time>
      </div>
      <div class="updated">
        <time><strong>Updated:</strong> August 08, 2011</time>
      </div>
      <div class="comments">
        <span><strong>Comments:</strong> <a href="#disqus_thread" class="load-comments" data-disqus-identifier="http://updates.html5rocks.com/2011/08/Saving-generated-files-on-the-client-side">0</a></span>
      </div>
      <div id="notcompatible" class="hidden">
        Your browser may not support the functionality in this article.
      </div>
    </section>
  </section>
  <section class="content">
    <p>Have you ever wanted to add a <q>Save as&hellip;</q> button to a webapp? Whether you're making an advanced <a href="https://developer.mozilla.org/en/WebGL">WebGL</a>-powered <abbr title="computer-aided design">CAD</abbr> webapp and want to save 3D object files or you just want to save plain text files in a simple Markdown text editor, saving files in the browser has always been a tricky business. Usually when you want to save a file generated with JavaScript, you have to send the data to your server and then return the data right back with a <code>Content-disposition: attachment</code> header. This is less than ideal for webapps that need to work offline. The W3C File API includes a <a href="http://www.w3.org/TR/file-writer-api/#the-filesaver-interface"><code>FileSaver</code> interface</a>, which makes saving generated data as easy as <code>saveAs(data, filename)</code>, though unfortunately it will eventually be removed from the spec. I have written a JavaScript library called <a href="https://github.com/eligrey/FileSaver.js">FileSaver.js</a>, which implements <code>FileSaver</code> in all modern browsers. Now that it's possible to generate any type of file you want right in the browser, document editors can have an instant save button that doesn't rely on an online connection. When paired with the standard HTML5 <a href="http://www.w3.org/TR/html5/the-canvas-element.html"><code>canvas.toBlob()</code></a> method, FileSaver.js lets you save canvases instantly and give them filenames, which is very useful for HTML5 image editing webapps. For browsers that don't yet support <code>canvas.toBlob()</code>, <a href="https://github.com/eboyjr">Devin Samarin</a> and I wrote <a href="https://github.com/eligrey/canvas-toBlob.js">canvas-toBlob.js</a>. Saving a canvas is as simple as running the following code:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">canvas</span><span class="p">.</span><span class="nx">toBlob</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">blob</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">saveAs</span><span class="p">(</span><span class="nx">blob</span><span class="p">,</span> <span class="nx">filename</span><span class="p">);</span>
<span class="p">});</span></code></pre></div>

<p>I have created a <a href="http://oftn.org/projects/FileSaver.js/demo/">demo</a> of FileSaver.js in action that demonstrates saving a canvas doodle, plain text, and rich text. Please note that saving with custom filenames is only supported in browsers that either natively support <code>FileSaver</code> or browsers like <a href="http://www.chromium.org/getting-involved/dev-channel">Google Chrome 14 dev</a> and <a href="http://tools.google.com/dlpage/chromesxs">Google Chrome Canary</a>, that support <a href="http://developers.whatwg.org/links.html#downloading-resources">&lt;a&gt;.download</a> or web filesystems via <a href="http://www.w3.org/TR/file-system-api/#using-localfilesystem"><code>LocalFileSystem</code></a>.</p>

<figure><a href="http://eligrey.com/demos/FileSaver.js/"><img style="border:1px solid #ccc;max-width: 100%;" src="http://dl.dropbox.com/u/39519/filesaverss.png" />
<figcaption>View FileSaver.js demo</figcaption></a></figure>

<h2>How to construct files for saving</h2>

<p>First off, you want to instantiate a <a href="https://developer.mozilla.org/en/DOM/BlobBuilder"><code>BlobBuilder</code></a>. The <code>BlobBuilder</code> API isn't supported in all current browsers, so I made <a href="https://github.com/eligrey/BlobBuilder.js">BlobBuilder.js</a> which implements it. The following example illustrates how to save an XHTML document with <code>saveAs()</code>.</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">bb</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BlobBuilder</span><span class="p">();</span>
<span class="nx">bb</span><span class="p">.</span><span class="nx">append</span><span class="p">((</span><span class="k">new</span> <span class="nx">XMLSerializer</span><span class="p">).</span><span class="nx">serializeToString</span><span class="p">(</span><span class="nb">document</span><span class="p">));</span>
<span class="kd">var</span> <span class="nx">blob</span> <span class="o">=</span> <span class="nx">bb</span><span class="p">.</span><span class="nx">getBlob</span><span class="p">(</span><span class="s2">&quot;application/xhtml+xml;charset=&quot;</span> <span class="o">+</span> <span class="nb">document</span><span class="p">.</span><span class="nx">characterSet</span><span class="p">);</span>
<span class="nx">saveAs</span><span class="p">(</span><span class="nx">blob</span><span class="p">,</span> <span class="s2">&quot;document.xhtml&quot;</span><span class="p">);</span></code></pre></div>

<p>Not saving textual data? You can append binary <code>Blob</code>s and <a href="https://developer.mozilla.org/en/JavaScript_typed_arrays"><code>ArrayBuffer</code>s</a> to a <code>BlobBuilder</code> too! The following is an example of setting generating some binary data and saving it.</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">bb</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BlobBuilder</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ArrayBuffer</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span> <span class="c1">// allocates 8 bytes</span>
<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DataView</span><span class="p">(</span><span class="nx">buffer</span><span class="p">);</span>

<span class="c1">// You can write (u)int8/16/32s and float32/64s to dataviews</span>
<span class="nx">data</span><span class="p">.</span><span class="nx">setUint8</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">);</span>
<span class="nx">data</span><span class="p">.</span><span class="nx">setUint16</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mh">0x2345</span><span class="p">);</span>
<span class="nx">data</span><span class="p">.</span><span class="nx">setUint32</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mh">0x6789ABCD</span><span class="p">);</span>
<span class="nx">data</span><span class="p">.</span><span class="nx">setUint8</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">);</span>

<span class="nx">bb</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">buffer</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">blob</span> <span class="o">=</span> <span class="nx">bb</span><span class="p">.</span><span class="nx">getBlob</span><span class="p">(</span><span class="s2">&quot;example/binary&quot;</span><span class="p">);</span>
<span class="nx">saveAs</span><span class="p">(</span><span class="nx">blob</span><span class="p">,</span> <span class="s2">&quot;data.dat&quot;</span><span class="p">);</span>
<span class="c1">// The contents of data.dat are &amp;lt;01 23 45 67 89 AB CD EF&amp;gt;</span></code></pre></div>

<p>If you're generating large files, you can implement an abort button that aborts the <code>FileSaver</code>.</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">filesaver</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FileSaver</span><span class="p">(</span><span class="nx">blob</span><span class="p">,</span> <span class="s2">&quot;video.webm&quot;</span><span class="p">);</span>
<span class="nx">abort_button</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">filesaver</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span></code></pre></div>


  </section>
  <section>
    <!-- TODO: Update link. -->
    
      <a href="/tag/file_access" class="tag">file access</a>
    
      <a href="/tag/nuts_and_bolts" class="tag">nuts and bolts</a>
    
      <a href="/tag/code" class="tag">code</a>
    
      <a href="/tag/filesystem" class="tag">filesystem</a>
    
  </section>
  <div class="pager">
    
    <a href="/2011/08/Seek-into-local-files-with-the-File-System-API">&laquo; Seek into local files with the File System API</a>
     | 
    <a href="/2011/08/Debugging-the-Filesystem-API">Debugging the Filesystem API &raquo;</a>
    
  </div>
</div>
</article>
<section class="disqus pattern-bg-lighter">
  <div id="disqus" class="container">
    <h2>Comments</h2>
    <div id="disqus_thread">
      <a href="#disqus_thread" class="load-comments"
          data-disqus-identifier="http://updates.html5rocks.com/2011/08/Saving-generated-files-on-the-client-side">0</a>
    </div>
  </div>

  <noscript>
    <p class="center">
      <strong>
        <a href="http://disqus.com/?ref_noscript">Please enable JavaScript to view the comments powered by Disqus.</a>
      </strong>
    </p>
  </noscript>

  <script>

    var disqus_shortname = 'html5rocks';
    var disqus_identifier = 'http://updates.html5rocks.com/2011/08/Saving-generated-files-on-the-client-side';
    var disqus_url = 'http://updates.html5rocks.com/2011/08/Saving-generated-files-on-the-client-side';
    var disqus_developer = 0;

    var disqus_config = function () {
      var funky_language_code_mapping = {
        'de': 'de_inf',
        'es': 'es_ES',
        'pt': 'pt_EU',
        'sr': 'sr_CYRL',
        'sv': 'sv_SE',
        'zh': 'zh_HANT'
      };
      this.language = funky_language_code_mapping['en'] ||
                      'en';

      this.callbacks.onReady = [ function () {
                                    try {
                                      ga('send', 'event', 'View comments');
                                    } catch(err){}
                                 } ];
      this.callbacks.onNewComment = [ function (comment) {
                                        try {
                                          ga('send', 'event', 'Commented');
                                        } catch(err){}
                                      } ];
    };

    window.addEventListener('load', function(e) {

      var c = document.createElement('script');
      c.type = 'text/javascript';
      c.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      c.async = true;

      var s = document.getElementsByTagName('script')[0], sp = s.parentNode;
      sp.insertBefore(c, s);

      if (window.location.hash === '#disqus_thread')
        loadComments();

    }, false);

    var disqus_loaded = false;
    function loadComments() {

      if (disqus_loaded)
        return;

      disqus_loaded = true;

      ga('send', 'event', 'Interactions', 'Comments', 'Comments Loaded');

      var s = document.getElementsByTagName('script')[0], sp = s.parentNode;
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;

      var disqusContainer = document.getElementById('disqus');
      disqusContainer.classList.add('active');

      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      sp.insertBefore(dsq, s);
    }
    var loadCommentsButtons = document.querySelectorAll('.load-comments');
    for(var l = 0; l < loadCommentsButtons.length; l++)
      loadCommentsButtons[l].addEventListener('click', loadComments);

  </script>
</section>



    </div>
    <footer>
  <div class="container">
    
    <h1>Next steps</h1>
    <aside class="panel share">
      <h2>Share</h2>
        <a href="https://twitter.com/share?url=http://www.html5rocks.com/tutorials/shapes/getting-started/&amp;text=Getting Started with CSS Shapes&amp;lang=en&amp;via=ChromiumDev&amp;related=ChromiumDev" class="twitter" target="_blank">Twitter</a>
        <a href="https://www.facebook.com/sharer/sharer.php?u=http://www.html5rocks.com/tutorials/shapes/getting-started/" class="facebook" target="_blank">Facebook</a>
        <a href="https://plus.google.com/share?url=http://www.html5rocks.com/tutorials/shapes/getting-started/" class="gplus" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">Google+</a>
    </aside>
    <aside class="panel rss">
      <h2>Subscribe</h2>
      <p>Enjoyed this article? Grab the <a href="/rss">RSS feed</a> and stay up-to-date.</p>
    </aside>
    
    <p class="licensing">
      Except as otherwise <a href="http://code.google.com/policies.html#restrictions">noted</a>, the content of this page is licensed under the <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 License</a>, and code samples are licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>.
    </p>
  </div>
</footer>


    <script>
      (function() {

        var siteHeader = document.getElementById('siteheader');
        var navToggle = document.getElementById('navtoggle');
        var siteNav = document.getElementById('sitenav');

        navToggle.addEventListener('click', function(e) {
          siteNav.classList.toggle('active');
          e.preventDefault();
        });

      })();
    </script>

    <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create','UA-15028909-7','auto');
      ga('create','UA-49880327-4','auto',{'name':'html5rocks'});
      ga('send','pageview');
      ga('html5rocks.send','pageview');
    </script>
  </body>
</html>
