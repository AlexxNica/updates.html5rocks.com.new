<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta property="twitter:account_id" content="1593210261" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="A resource for developers looking to put HTML5 to use today, including information on specific features and when to use them in your apps.">
<meta name="keywords" content="html5,html 5,html5 demos,html5 examples,javascript,css3,notifications,geolocation,web workers,apppcache,file api,filereader,indexeddb,offline,audio,video,drag and drop,chrome,sse,mobile">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Respond to change with Object.observe</title>

<!-- Add to homescreen for Chrome on Android -->
<meta name="mobile-web-app-capable" content="yes">
<link rel="icon" sizes="192x192" href="  /assets/HTML5_Badge_192-f9389f6cad587f357d82be791970c8ad.png">

<!-- Add to homescreen for Safari on iOS -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="HTML5 Rocks">
<link rel="apple-touch-icon-precomposed" href="/assets/HTML5_Badge_192-f9389f6cad587f357d82be791970c8ad.png
">

<!-- Tile icon for Win8 (144x144 + tile color) -->
<meta name="msapplication-TileImage" content="/assets/HTML5_Badge_144-ddcf1cea1a1204b1733041733d66f76a.png
">
<meta name="msapplication-TileColor" content="#3372DF">

<!-- TODO: consider rel=canonical -->
<!-- TODO: consider rel=publisher -->
<link rel="alternate" type="application/rss+xml" title="HTML5 Rocks RSS" href="http://feeds.feedburner.com/html5rocks">
<link rel="publisher" href="https://plus.google.com/+GoogleChromeDevelopers">




  




<link href="//fonts.googleapis.com/css?family=Open+Sans:600,800|Source+Code+Pro" rel="stylesheet">
<link rel="stylesheet" href="/assets/main-8dae1b06ec239bb8b24c3d98cd1ad04b.css">

<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5-els.js"></script>
<![endif]-->

  </head>
  <body>
    <header class="main" id="siteheader">
  <a href="#sitenav" id="navtoggle"></a>
  <nav id="sitenav" class="container">
    <ul>
      <li id="tutorials_menu">
        <a href="http://www.html5rocks.com" class="tutorials">Home</a>
      </li>
      <li id="tutorials_menu">
        <a href="http://www.html5rocks.com/en/tutorials/?page=1" class="tutorials">Tutorials</a>
      </li>
      <li id="updates_menu">
        <a href="http://www.html5rocks.com/en/updates" class="updates">Updates</a>
      </li>
      <li id="contrib_menu">
        <a href="https://github.com/html5rocks/www.html5rocks.com/blob/master/CONTRIBUTING.md" target="_blank">Contribute</a>
      </li>
      <li id="slides_menu">
        <a href="http://www.html5rocks.com/en/slides" class="slides">Slides</a>
      </li>
      <li id="resources_menu">
        <a href="http://www.html5rocks.com/en/resources" class="resources">Resources</a>
      </li>
    </ul>
  </nav>
</header>

    <div class="body-content">
      <section class="banner">
        <section class="container">
          <a href="/en/" class="watermark"></a>
          <h1>Respond to change with Object.observe</h1>
          
        </section>
      </section>
      <article class="content-wrapper article">
<div class="container">
  <section class="byline clearfix">
    <section class="author-images">
      
        
<!-- TODO: change image address.-->

<img src="http://www.html5rocks.com/static/images/profiles/alexdanilo.png"
     alt="Alex Danilo"
     title="Alex Danilo"
     width="60" height="60"
     class="avatar">



      
    </section>
    <section class="meta">
      <div class="authors">
          
    
    <!-- TODO: change link. -->
    <strong>By</strong> <a href="http://www.html5rocks.com/profiles/#alexdanilo">
      Alex Danilo
    </a> 
  

      </div>
      <div class="published">
        <time pubdate=""><strong>Published:</strong> November 28, 2012</time>
      </div>
      <div class="updated">
        <time><strong>Updated:</strong> November 28, 2012</time>
      </div>
      <div class="comments">
        <span><strong>Comments:</strong> <a href="#disqus_thread" class="load-comments" data-disqus-identifier="http://updates.html5rocks.com/2012/11/Respond-to-change-with-Object-observe"></a></span>
      </div>
      <div id="notcompatible" class="hidden">
        Your browser may not support the functionality in this article.
      </div>
    </section>
  </section>
  <section class="content">
    <p>Lots of JavaScript frameworks using MVC or MDV need to respond to changes to the objects that model the state inside a web application. This capability is a fundamental part of a data-binding model.</p>

<p>There are a number of different ways to monitor JavaScript objects and DOM properties to trigger some sort of action, but most of the techniques aren’t ideal for various reasons such as performance, etc.</p>

<p>In order to improve the performance of web applications, a new method called <a href="http://wiki.ecmascript.org/doku.php?id=harmony:observe">Object.observe()</a> has been proposed to TC39 - the standards body overseeing development of ECMAScript (JavaScript).</p>

<p>Object.observe() lets you add a listener to any JavaScript object that gets called whenever that object, or its properties, change.</p>

<p>You can try it out now in <a href="https://tools.google.com/dlpage/chromesxs">Chrome Canary</a> version 25.</p>

<p>To experiment with this feature, you need to enable the <em>Enable Experimental JavaScript</em> flag in Chrome Canary and restart the browser. The flag can be found under ‘about:flags’ as shown in the image below:</p>

<p><img src="/images/AMIfv95OLcv7FCAxzBOKUS3pzzp8SWBRJfEcGUZRs88VbIrR0zrLh54ihIPN3mmvxXT_bG4FQoo1gK2EGPvdtJzVPTnwHmEwk4_JeXWCZgn0_zjFMR3J4yHmU49tc7KBFrYEKYtZmucJNIZD3xmIi_qyLKVPflIZxw" /></p>

<p>Here’s a simple example of how to set up an observer on an object:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">beingWatched</span> <span class="o">=</span> <span class="p">{};</span>
<span class="c1">// Define callback function to get notified on changes</span>
<span class="kd">function</span> <span class="nx">somethingChanged</span><span class="p">(</span><span class="nx">changes</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do something</span>
<span class="p">}</span>
<span class="nb">Object</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">beingWatched</span><span class="p">,</span> <span class="nx">somethingChanged</span><span class="p">);</span></code></pre></div>

<p>When the object ‘beingWatched’ is modified, it will trigger the callback function ‘somethingChanged’ which receives an array of changes that were applied to the object.</p>

<p>So the JavaScript engine is free to buffer up a number of changes and pass them all in a single call to the callback function. This helps with optimizing the callbacks so that your code can do lots of JavaScript manipulation but process only a few callbacks by batching the updates together.</p>

<p>The callback function will be triggered whenever a property is added, modified, deleted or reconfigured.</p>

<p>Another really nice thing when observing arrays is that if an array has had a number of changes made to it, you can use a <a href="https://github.com/rafaelw/ChangeSummary">Change Summary</a> helper library to create a minimal change set, so that client side JavaScript doesn’t have to manually scan the array to check each item.</p>

<p>You can iterate through each change quite easily, by doing something like the following in your ‘somethingChanged’ callback function:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">whatHappened</span><span class="p">(</span><span class="nx">change</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">change</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot; was &quot;</span> <span class="o">+</span> <span class="nx">change</span><span class="p">.</span><span class="nx">type</span> <span class="o">+</span> <span class="s2">&quot; and is now &quot;</span> <span class="o">+</span> <span class="nx">change</span><span class="p">.</span><span class="nx">object</span><span class="p">[</span><span class="nx">change</span><span class="p">.</span><span class="nx">name</span><span class="p">]);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">somethingChanged</span><span class="p">(</span><span class="nx">changes</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">changes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">whatHappened</span><span class="p">);</span>
<span class="p">}</span></code></pre></div>

<p>The <em>type</em> property identifies what happened to the object. Some examples of properties being set and the associated <em>type</em> can be seen in the code below.</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">beingWatched</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="s2">&quot;foo&quot;</span><span class="p">;</span> <span class="c1">// new</span>
<span class="nx">beingWatched</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="p">;</span> <span class="c1">// updated</span>
<span class="nx">beingWatched</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="p">;</span> <span class="c1">// no change</span>
<span class="nx">beingWatched</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="s2">&quot;amazing&quot;</span><span class="p">;</span> <span class="c1">// new</span></code></pre></div>

<p>The great thing about this technique is that all the monitoring smarts are inside the JavaScript engine which allows the browser to optimize it well and free your JavaScript up to implement functionality taking advantage of this feature.</p>

<p>Another really great feature for development is the ability to use Object.observe() to trigger the debugger whenever an object changes. To do that you’d use code something like the example below.</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">Object</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">beingWatched</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span> <span class="kr">debugger</span><span class="p">;</span> <span class="p">});</span></code></pre></div>

<p>Here’s a <a href="https://www.youtube.com/watch?feature=player_embedded&amp;v=VO--VXFJnmE">great video introduction</a> about Object.observe() that explains it in detail.</p>

<div class="video-container"><iframe src="//www.youtube.com/embed/VO--VXFJnmE " frameborder="0" allowfullscreen=""></iframe></div>

<p>There’s also a <a href="http://weblog.bocoup.com/JavaScript-object-observe/">nice descriptive write-up available</a> and a <a href="http://simpl.info/observe/">working example here</a>.</p>

<p>The TC39 standards body is seeking feedback on this feature, so go ahead and try it and let us know what you think.</p>

  </section>
  <section>
    <!-- TODO: Update link. -->
    
      <a href="/tag/javascript" class="tag">javascript</a>
    
  </section>
  <div class="pager">
    
    <a href="/2012/11/Content-Security-Policy-1-0-is-officially-awesome">&laquo; Content Security Policy 1.0 is officially awesome.</a>
     | 
    <a href="/2012/12/WebRTC-hits-Firefox-Android-and-iOS">WebRTC hits Firefox, Android and iOS &raquo;</a>
    
  </div>
</div>
</article>
<section class="disqus pattern-bg-lighter">
  <div id="disqus" class="container">
    <h2>Comments</h2>
    <div id="disqus_thread">
      <a href="#disqus_thread" class="load-comments"
          data-disqus-identifier="http://updates.html5rocks.com/2012/11/Respond-to-change-with-Object-observe">0</a>
    </div>
  </div>

  <noscript>
    <p class="center">
      <strong>
        <a href="http://disqus.com/?ref_noscript">Please enable JavaScript to view the comments powered by Disqus.</a>
      </strong>
    </p>
  </noscript>

  <script>

    var disqus_shortname = 'html5rocks';
    var disqus_identifier = 'http://updates.html5rocks.com/2012/11/Respond-to-change-with-Object-observe';
    var disqus_url = 'http://updates.html5rocks.com/2012/11/Respond-to-change-with-Object-observe';
    var disqus_developer = 0;

    var disqus_config = function () {
      var funky_language_code_mapping = {
        'de': 'de_inf',
        'es': 'es_ES',
        'pt': 'pt_EU',
        'sr': 'sr_CYRL',
        'sv': 'sv_SE',
        'zh': 'zh_HANT'
      };
      this.language = funky_language_code_mapping['en'] ||
                      'en';

      this.callbacks.onReady = [ function () {
                                    try {
                                      ga('send', 'event', 'View comments');
                                    } catch(err){}
                                 } ];
      this.callbacks.onNewComment = [ function (comment) {
                                        try {
                                          ga('send', 'event', 'Commented');
                                        } catch(err){}
                                      } ];
    };

    window.addEventListener('load', function(e) {

      var c = document.createElement('script');
      c.type = 'text/javascript';
      c.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      c.async = true;

      var s = document.getElementsByTagName('script')[0], sp = s.parentNode;
      sp.insertBefore(c, s);

      if (window.location.hash === '#disqus_thread')
        loadComments();

    }, false);

    var disqus_loaded = false;
    function loadComments() {

      if (disqus_loaded)
        return;

      disqus_loaded = true;

      ga('send', 'event', 'Interactions', 'Comments', 'Comments Loaded');

      var s = document.getElementsByTagName('script')[0], sp = s.parentNode;
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;

      var disqusContainer = document.getElementById('disqus');
      disqusContainer.classList.add('active');

      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      sp.insertBefore(dsq, s);
    }
    var loadCommentsButtons = document.querySelectorAll('.load-comments');
    for(var l = 0; l < loadCommentsButtons.length; l++)
      loadCommentsButtons[l].addEventListener('click', loadComments);

  </script>
</section>



    </div>
    <footer>
  <div class="container">
    
    <h1>Next steps</h1>
    <aside class="panel share">
      <h2>Share</h2>
        <a href="https://twitter.com/share?url=http://www.html5rocks.com/tutorials/shapes/getting-started/&amp;text=Getting Started with CSS Shapes&amp;lang=en&amp;via=ChromiumDev&amp;related=ChromiumDev" class="twitter" target="_blank">Twitter</a>
        <a href="https://www.facebook.com/sharer/sharer.php?u=http://www.html5rocks.com/tutorials/shapes/getting-started/" class="facebook" target="_blank">Facebook</a>
        <a href="https://plus.google.com/share?url=http://www.html5rocks.com/tutorials/shapes/getting-started/" class="gplus" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">Google+</a>
    </aside>
    <aside class="panel rss">
      <h2>Subscribe</h2>
      <p>Enjoyed this article? Grab the <a href="http://feeds.feedburner.com/html5rocks">RSS feed</a> and stay up-to-date.</p>
    </aside>
    
    <p class="licensing">
      Except as otherwise <a href="http://code.google.com/policies.html#restrictions">noted</a>, the content of this page is licensed under the <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 License</a>, and code samples are licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>.
    </p>
  </div>
</footer>


    <script>
      (function() {

        var siteHeader = document.getElementById('siteheader');
        var navToggle = document.getElementById('navtoggle');
        var siteNav = document.getElementById('sitenav');

        navToggle.addEventListener('click', function(e) {
          siteNav.classList.toggle('active');
          e.preventDefault();
        });

      })();
    </script>

    <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create','UA-15028909-7','auto');
      ga('create','UA-49880327-4','auto',{'name':'html5rocks'});
      ga('send','pageview');
      ga('html5rocks.send','pageview');
    </script>
  </body>
</html>
