<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta property="twitter:account_id" content="1593210261" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="A resource for developers looking to put HTML5 to use today, including information on specific features and when to use them in your apps.">
<meta name="keywords" content="html5,html 5,html5 demos,html5 examples,javascript,css3,notifications,geolocation,web workers,apppcache,file api,filereader,indexeddb,offline,audio,video,drag and drop,chrome,sse,mobile">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Profiling Long Paint Times with DevTools' Continuous Painting Mode</title>

<!-- Add to homescreen for Chrome on Android -->
<meta name="mobile-web-app-capable" content="yes">
<link rel="icon" sizes="192x192" href="  /assets/HTML5_Badge_192-f9389f6cad587f357d82be791970c8ad.png">

<!-- Add to homescreen for Safari on iOS -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="HTML5 Rocks">
<link rel="apple-touch-icon-precomposed" href="/assets/HTML5_Badge_192-f9389f6cad587f357d82be791970c8ad.png
">

<!-- Tile icon for Win8 (144x144 + tile color) -->
<meta name="msapplication-TileImage" content="/assets/HTML5_Badge_144-ddcf1cea1a1204b1733041733d66f76a.png
">
<meta name="msapplication-TileColor" content="#3372DF">

<!-- TODO: consider rel=canonical -->
<!-- TODO: consider rel=publisher -->
<link rel="alternate" type="application/rss+xml" title="HTML5 Rocks RSS" href="http://feeds.feedburner.com/html5rocks">
<link rel="publisher" href="https://plus.google.com/+GoogleChromeDevelopers">




  




<link href="//fonts.googleapis.com/css?family=Open+Sans:600,800|Source+Code+Pro" rel="stylesheet">
<link rel="stylesheet" href="/assets/main-8dae1b06ec239bb8b24c3d98cd1ad04b.css">

<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5-els.js"></script>
<![endif]-->

  </head>
  <body>
    <header class="main" id="siteheader">
  <a href="#sitenav" id="navtoggle"></a>
  <nav id="sitenav" class="container">
    <ul>
      <li id="tutorials_menu">
        <a href="http://www.html5rocks.com" class="tutorials">Home</a>
      </li>
      <li id="tutorials_menu">
        <a href="http://www.html5rocks.com/en/tutorials/?page=1" class="tutorials">Tutorials</a>
      </li>
      <li id="updates_menu">
        <a href="http://www.html5rocks.com/en/updates" class="updates">Updates</a>
      </li>
      <li id="contrib_menu">
        <a href="https://github.com/html5rocks/www.html5rocks.com/blob/master/CONTRIBUTING.md" target="_blank">Contribute</a>
      </li>
      <li id="slides_menu">
        <a href="http://www.html5rocks.com/en/slides" class="slides">Slides</a>
      </li>
      <li id="resources_menu">
        <a href="http://www.html5rocks.com/en/resources" class="resources">Resources</a>
      </li>
    </ul>
  </nav>
</header>

    <div class="body-content">
      <section class="banner">
        <section class="container">
          <a href="/en/" class="watermark"></a>
          <h1>Profiling Long Paint Times with DevTools' Continuous Painting Mode</h1>
          
        </section>
      </section>
      <article class="content-wrapper article">
<div class="container">
  <section class="byline clearfix">
    <section class="author-images">
      
        
<!-- TODO: change image address.-->

<img src="http://www.html5rocks.com/static/images/profiles/paulirish.png"
     alt="Paul Irish"
     title="Paul Irish"
     width="60" height="60"
     class="avatar">



      
    </section>
    <section class="meta">
      <div class="authors">
          
    
    <!-- TODO: change link. -->
    <strong>By</strong> <a href="http://www.html5rocks.com/profiles/#paulirish">
      Paul Irish
    </a> 
  

      </div>
      <div class="published">
        <time pubdate=""><strong>Published:</strong> February 19, 2013</time>
      </div>
      <div class="updated">
        <time><strong>Updated:</strong> February 19, 2013</time>
      </div>
      <div class="comments">
        <span><strong>Comments:</strong> <a href="#disqus_thread" class="load-comments" data-disqus-identifier="http://updates.html5rocks.com/2013/02/Profiling-Long-Paint-Times-with-DevTools-Continuous-Painting-Mode">0</a></span>
      </div>
      <div id="notcompatible" class="hidden">
        Your browser may not support the functionality in this article.
      </div>
    </section>
  </section>
  <section class="content">
    <script>(function(){
var scripts = document.querySelectorAll('script');
var thisscript = scripts[scripts.length-1];
thisscript.parentNode.parentNode.id = 'continuouspaint';
})();</script>

<p><strong>Continuous painting mode</strong> for paint profiling is now available in<a href="https://www.google.com/intl/en/chrome/browser/canary.html">
</a><a href="https://www.google.com/intl/en/chrome/browser/canary.html">Chrome
Canary</a>. This
article explains how you identify a problem in page painting time and how you
can use this new tool to detect bottlenecks in painting performance.
</p>
<h3>Investigating painting time on your page</h3>
<p>So you noticed that your page doesn't scroll smoothly. This is how you would
start tackling the problem. For our example, we'll use the demo page <a href="http://css3exp.com/moon/">Things We Left On The Moon</a> by <a href="http://simplebits.com/">Dan Cederholm</a> as our example.
</p>
<p>You open the Web Inspector, start a Timeline recording and scroll your page up
and down. Then you look at the vertical timelines, that show you what happened
in each frame.<br />
</p>
<p><img width="900" src="http://i.imgur.com/iM0oKjk.png" /></p>
<p>If you see that most time is spent painting (big green bars above 60fps), you
need to take a closer look at why this is happening. To investigate your paints,
use the <strong>Show paint rectangles</strong> setting of the Web Inspector (cog icon in the
bottom right corner of the Web Inspector). This will show you the regions where
Chrome paints.
</p>
<p><img width="900" src="http://i.imgur.com/5fa1nMd.png" /></p>
<p>There are different reasons for Chrome to repaint areas of the page:
</p>
<ul>
<li>
DOM nodes get changed in JavaScript, which causes Chrome to recalculate the
layout of the page.
</li>
<li>
Animations are playing that get updated in a frame-based cycle.
</li>
<li>
User interaction, like hovering, causes style changes on certain elements.
</li>
<li>
Any other operation that causes the page layout to change.
</li>
</ul>
<p>As a developer you need to be aware of the repaints happening on your page.
Looking at the paint rectangles is a great way of doing that. In the example
screenshot above you can see that the whole screen is covered in a big paint
rectangle. This means the whole screen is repainted as you scroll, which is not
good. In this specific case this is caused by the CSS style
<code>background-attachment:fixed</code> which causes the background image of the page to
stay at the same position while the content of the page moves on top of it as
you scroll.
</p>
<p>If you identify that the repaints cover a big area and/or take a long time, you
have two options:
</p>
<ol>
<li><p>You can try to change the page layout to reduce the amount of painting. If
possible Chrome paints the visible page only once and adds parts that have
not been visible as you scroll down. However, there are cases when Chrome
needs to repaint certain areas. For example the CSS rule <code>position:fixed</code>,
which is often used for navigation elements that stay in the same position,
can cause these repaints.
</p>
</li>
<li><p>If you want to keep your page layout, you can try to reduce the painting cost
of the areas that get repainted. Not every CSS style has the same painting
cost, some have little impact, others a lot. Figuring out the painting costs
of certain styles can be a lot of work. You can do this by toggling styles in
the Elements panel and looking at the difference in the Timeline recording,
which means switching between panels and doing lots of recordings. This is
where <strong>continuous painting mode</strong> comes into play.
</p>
</li>
</ol>
<h2>Continuous painting mode</h2>
<p><strong>Continuous painting mode</strong> is a tool that helps you identify which elements
are costly on the page. It puts the page into an always repainting state,
showing a counter of how much painting work is happening. Then, you can hide
elements and mutate styles, watching the counter, in order to figure out what is
slow.
</p>
<h3>Setup</h3>
<p>In order to use <strong>continuous painting mode</strong> you need to use <a href="https://www.google.com/intl/en/chrome/browser/canary.html">Chrome
Canary</a>.
</p>
<p>On <strong>Linux</strong> systems (and some Macs) you need to make sure that Chrome runs in
compositing mode. This can be permanently enabled using the <strong>GPU compositing on
all pages</strong> setting in <code>about:flags</code>.
</p>
<h3>How To Begin</h3>
<p><strong>Continuous painting mode</strong> can be enabled via the checkbox <strong>Enable continuous
page repainting</strong> in the Web Inspector's settings (cog icon in the bottom right
corner of the Web Inspector).
</p>
<p><img width="900" src="http://i.imgur.com/UYXJODj.png" /></p>
<p>The small display in the top right corner shows you the measured paint times in
milliseconds. More specifically it shows:
</p>
<ul>
<li>
The last measured paint time on the left.
</li>
<li>
The minimum and maximum of the current graph on the right.
</li>
<li>
A bar chart displaying the history of the last 80 frames on the bottom (the
line in the chart indicates 16ms as a reference point).
</li>
</ul>
<p>The paint time measurements are dependent on screen resolution, window size and
the hardware Chrome is running on. Be aware that these things are likely to be
different for your users.
</p>
<h3>Workflow</h3>
<p>This is how you can use <strong>continuous painting mode</strong> to track down elements and
styles that add a lot of painting cost:
</p>
<ol>
<li>
Open the Web Inspector's settings and check <strong>Enable continuous page
repainting</strong>.
</li>
<li>
Go to the Elements panel and traverse the DOM tree with the arrow keys or by
picking elements on the page.
</li>
<li>
Use the <strong>H keyboard shortcut</strong>, a newly introduced helper, to toggle visibility on an
element.
</li>
<li>
Look at the paint time graph and try to spot an element that adds a lot of
painting time.
</li>
<li>
Go through the CSS styles of that element, toggling them on and off while
looking at the graph, to find the style that causes the slow down.
</li>
<li>
Change this style and do another Timeline recording to check if this made
your page perform better.
</li>
</ol>
<p>The animation below shows toggling styles and its affect on paint time:
</p>
<p><img pagespeed_lazy_src="https://dl.dropbox.com/u/39519/temp/cssmoon-continuouspaint.gif" alt="continuouspaint screencast" src="//1-ps.googleusercontent.com/h/www.gstatic.com/psa/static/1.gif" onload="pagespeed.lazyLoadImages.loadIfVisible(this);" pagespeed_lazy_replaced_functions="1" />
</p>
<p>This example demonstrates how turning either one of the CSS styles <code>box-shadow</code>
or <code>border-radius</code> off, reduces the painting time by a big amount. Using both <code>box-shadow</code> and<code>border-radius</code> on an element leads to very expensive painting
operations, because Chrome can't optimize for this. So if you have an element
that gets a lot of repaints, like in the example, you should avoid this
combination.
</p>
<h3>Notes</h3>
<p><strong>Continuous painting mode</strong> repaints the whole visible page. This is usually
not the case when browsing a web page. Scrolling usually only paints the parts
that haven't been visible before. And for other changes on the page, only the
smallest possible area is repainted. So check with another Timeline recording if
your style improvements actually had an impact on the paint times of your page.
</p>
<p>When using <strong>continuous painting mode</strong> you might discover that e.g. the CSS
styles <code>border-radius</code> and <code>box-shadow</code> add a lot of painting time. It is not
discouraged to use those features in general, they are awesome and we are happy
they are finally here. But it's important to know when and where to use them.
Avoid using them in areas with lots of repaints and avoid overusing them in
general.
</p>
<p>Learn more about painting and related topics on <a href="http://jankfree.com">jankfree.com</a>
</p>

<aside class="bio clearfix" style="border: 3px double #CCC; padding: 10px;">

&lt;img src="http://api.twitter.com/1/users/profile_image/egraether?size=normal" align=left style="margin: 0 10px 0 0; border: 1px solid gray; border-radius:2px"&gt;


Eberhard Gräther is student of <a href="http://multimediatechnology.at/in-english/">MultiMediaTechnology</a> at <a href="http://www.fh-salzburg.ac.at/en/">Salzburg University of Applied Sciences</a>. He interned in the Chrome GPU team from 10/2012 to 03/2013 where he worked on rendering profiling tools. Follow him at  <a href="https://twitter.com/egraether">@egraether</a> or visit <a href="http://egraether.com">his site</a> to find graphics demos and web games he has built.
</aside>

<h3>Live Demo</h3>

<p>
Click below for a demo where Paul Irish uses continuous painting to identify a uniquely expensive paint operation.</p>

<div class="video-container"><iframe src="//www.youtube.com/embed/FY5iiuQRyEE?start=683&amp;end=788 " frameborder="0" allowfullscreen=""></iframe></div>

<style>
section#continuouspaint .time-author a:before { content: "Eberhard Gräther ";}
section#continuouspaint .time-author a { display: inline-block;
width: 102px;
overflow: hidden;
height: 23px;
line-height: 21px;
text-decoration: none;
vertical-align: middle;
}
</style>


  </section>
  <section>
    <!-- TODO: Update link. -->
    
      <a href="/tag/performance" class="tag">performance</a>
    
      <a href="/tag/devtools" class="tag">devtools</a>
    
  </section>
  <div class="pager">
    
    <a href="/2013/02/WebRTC-data-channels-API-changes-and-Chrome-talks-to-Firefox">&laquo; WebRTC: RTCDataChannel demo, API changes... and Chrome talks to Firefox!</a>
     | 
    <a href="/2013/03/Visualizing-Shadow-DOM-Concepts">Visualizing Shadow DOM Concepts &raquo;</a>
    
  </div>
</div>
</article>
<section class="disqus pattern-bg-lighter">
  <div id="disqus" class="container">
    <h2>Comments</h2>
    <div id="disqus_thread">
      <a href="#disqus_thread" class="load-comments"
          data-disqus-identifier="http://updates.html5rocks.com/2013/02/Profiling-Long-Paint-Times-with-DevTools-Continuous-Painting-Mode">0</a>
    </div>
  </div>

  <noscript>
    <p class="center">
      <strong>
        <a href="http://disqus.com/?ref_noscript">Please enable JavaScript to view the comments powered by Disqus.</a>
      </strong>
    </p>
  </noscript>

  <script>

    var disqus_shortname = 'html5rocks';
    var disqus_identifier = 'http://updates.html5rocks.com/2013/02/Profiling-Long-Paint-Times-with-DevTools-Continuous-Painting-Mode';
    var disqus_url = 'http://updates.html5rocks.com/2013/02/Profiling-Long-Paint-Times-with-DevTools-Continuous-Painting-Mode';
    var disqus_developer = 0;

    var disqus_config = function () {
      var funky_language_code_mapping = {
        'de': 'de_inf',
        'es': 'es_ES',
        'pt': 'pt_EU',
        'sr': 'sr_CYRL',
        'sv': 'sv_SE',
        'zh': 'zh_HANT'
      };
      this.language = funky_language_code_mapping['en'] ||
                      'en';

      this.callbacks.onReady = [ function () {
                                    try {
                                      ga('send', 'event', 'View comments');
                                    } catch(err){}
                                 } ];
      this.callbacks.onNewComment = [ function (comment) {
                                        try {
                                          ga('send', 'event', 'Commented');
                                        } catch(err){}
                                      } ];
    };

    window.addEventListener('load', function(e) {

      var c = document.createElement('script');
      c.type = 'text/javascript';
      c.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      c.async = true;

      var s = document.getElementsByTagName('script')[0], sp = s.parentNode;
      sp.insertBefore(c, s);

      if (window.location.hash === '#disqus_thread')
        loadComments();

    }, false);

    var disqus_loaded = false;
    function loadComments() {

      if (disqus_loaded)
        return;

      disqus_loaded = true;

      ga('send', 'event', 'Interactions', 'Comments', 'Comments Loaded');

      var s = document.getElementsByTagName('script')[0], sp = s.parentNode;
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;

      var disqusContainer = document.getElementById('disqus');
      disqusContainer.classList.add('active');

      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      sp.insertBefore(dsq, s);
    }
    var loadCommentsButtons = document.querySelectorAll('.load-comments');
    for(var l = 0; l < loadCommentsButtons.length; l++)
      loadCommentsButtons[l].addEventListener('click', loadComments);

  </script>
</section>



    </div>
    <footer>
  <div class="container">
    
    <h1>Next steps</h1>
    <aside class="panel share">
      <h2>Share</h2>
        <a href="https://twitter.com/share?url=http://www.html5rocks.com/tutorials/shapes/getting-started/&amp;text=Getting Started with CSS Shapes&amp;lang=en&amp;via=ChromiumDev&amp;related=ChromiumDev" class="twitter" target="_blank">Twitter</a>
        <a href="https://www.facebook.com/sharer/sharer.php?u=http://www.html5rocks.com/tutorials/shapes/getting-started/" class="facebook" target="_blank">Facebook</a>
        <a href="https://plus.google.com/share?url=http://www.html5rocks.com/tutorials/shapes/getting-started/" class="gplus" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">Google+</a>
    </aside>
    <aside class="panel rss">
      <h2>Subscribe</h2>
      <p>Enjoyed this article? Grab the <a href="http://feeds.feedburner.com/html5rocks">RSS feed</a> and stay up-to-date.</p>
    </aside>
    
    <p class="licensing">
      Except as otherwise <a href="http://code.google.com/policies.html#restrictions">noted</a>, the content of this page is licensed under the <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 License</a>, and code samples are licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>.
    </p>
  </div>
</footer>


    <script>
      (function() {

        var siteHeader = document.getElementById('siteheader');
        var navToggle = document.getElementById('navtoggle');
        var siteNav = document.getElementById('sitenav');

        navToggle.addEventListener('click', function(e) {
          siteNav.classList.toggle('active');
          e.preventDefault();
        });

      })();
    </script>

    <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create','UA-15028909-7','auto');
      ga('create','UA-49880327-4','auto',{'name':'html5rocks'});
      ga('send','pageview');
      ga('html5rocks.send','pageview');
    </script>
  </body>
</html>
