<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta property="twitter:account_id" content="1593210261" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="A resource for developers looking to put HTML5 to use today, including information on specific features and when to use them in your apps.">
<meta name="keywords" content="html5,html 5,html5 demos,html5 examples,javascript,css3,notifications,geolocation,web workers,apppcache,file api,filereader,indexeddb,offline,audio,video,drag and drop,chrome,sse,mobile">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Alpha transparency in Chrome video</title>

<!-- Add to homescreen for Chrome on Android -->
<meta name="mobile-web-app-capable" content="yes">
<link rel="icon" sizes="192x192" href="  /assets/HTML5_Badge_192-f9389f6cad587f357d82be791970c8ad.png">

<!-- Add to homescreen for Safari on iOS -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="HTML5 Rocks">
<link rel="apple-touch-icon-precomposed" href="/assets/HTML5_Badge_192-f9389f6cad587f357d82be791970c8ad.png
">

<!-- Tile icon for Win8 (144x144 + tile color) -->
<meta name="msapplication-TileImage" content="/assets/HTML5_Badge_144-ddcf1cea1a1204b1733041733d66f76a.png
">
<meta name="msapplication-TileColor" content="#3372DF">

<!-- TODO: consider rel=canonical -->
<!-- TODO: consider rel=publisher -->
<link rel="alternate" type="application/rss+xml" title="HTML5 Rocks RSS" href="http://feeds.feedburner.com/html5rocks">
<link rel="publisher" href="https://plus.google.com/+GoogleChromeDevelopers">




  




<link href="//fonts.googleapis.com/css?family=Open+Sans:600,800|Source+Code+Pro" rel="stylesheet">
<link rel="stylesheet" href="/assets/main-8dae1b06ec239bb8b24c3d98cd1ad04b.css">

<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5-els.js"></script>
<![endif]-->

  </head>
  <body>
    <header class="main" id="siteheader">
  <a href="#sitenav" id="navtoggle"></a>
  <nav id="sitenav" class="container">
    <ul>
      <li id="tutorials_menu">
        <a href="http://www.html5rocks.com" class="tutorials">Home</a>
      </li>
      <li id="tutorials_menu">
        <a href="http://www.html5rocks.com/en/tutorials/?page=1" class="tutorials">Tutorials</a>
      </li>
      <li id="updates_menu">
        <a href="http://www.html5rocks.com/en/updates" class="updates">Updates</a>
      </li>
      <li id="contrib_menu">
        <a href="https://github.com/html5rocks/www.html5rocks.com/blob/master/CONTRIBUTING.md" target="_blank">Contribute</a>
      </li>
      <li id="slides_menu">
        <a href="http://www.html5rocks.com/en/slides" class="slides">Slides</a>
      </li>
      <li id="resources_menu">
        <a href="http://www.html5rocks.com/en/resources" class="resources">Resources</a>
      </li>
    </ul>
  </nav>
</header>

    <div class="body-content">
      <section class="banner">
        <section class="container">
          <a href="/en/" class="watermark"></a>
          <h1>Alpha transparency in Chrome video</h1>
          
        </section>
      </section>
      <article class="content-wrapper article">
<div class="container">
  <section class="byline clearfix">
    <section class="author-images">
      
        
<!-- TODO: change image address.-->

<img src="http://www.html5rocks.com/static/images/profiles/dutton.png"
     alt="Sam Dutton"
     title="Sam Dutton"
     width="60" height="60"
     class="avatar">



      
    </section>
    <section class="meta">
      <div class="authors">
          
    
    <!-- TODO: change link. -->
    <strong>By</strong> <a href="http://www.html5rocks.com/profiles/#dutton">
      Sam Dutton
    </a> 
  

      </div>
      <div class="published">
        <time pubdate=""><strong>Published:</strong> July 26, 2013</time>
      </div>
      <div class="updated">
        <time><strong>Updated:</strong> July 26, 2013</time>
      </div>
      <div class="comments">
        <span><strong>Comments:</strong> <a href="#disqus_thread" class="load-comments" data-disqus-identifier="http://updates.html5rocks.com/2013/07/Alpha-transparency-in-Chrome-video"></a></span>
      </div>
      <div id="notcompatible" class="hidden">
        Your browser may not support the functionality in this article.
      </div>
    </section>
  </section>
  <section class="content">
    <h1 id="alpha-transparency-in-chrome-video">Alpha transparency in Chrome video</h1>

<p>Chrome Canary now supports video alpha transparency in WebM.</p>

<p>In other words, Chrome takes the alpha channel into account when playing ‘<a href="https://en.wikipedia.org/wiki/Chroma_key">green
screen</a>’ videos encoded to WebM with
an alpha channel. This means you can play videos with transparent backgrounds: over web pages, images or even other videos.</p>

<p>There’s a demo at
<a href="http://simpl.info/videoalpha">simpl.info/videoalpha</a>. This only works in Chrome Canary at this point, and you’ll need to enable VP8 alpha transparency from the chrome://flags page. Somewhat surreal, and a bit rough around the edges (literally) but you get the idea!</p>

<p>Here’s a screencast:</p>

<div class="video-container"><iframe src="//www.youtube.com/embed/LIH_myX3Zp0 " frameborder="0" allowfullscreen=""></iframe></div>

<h1 id="how-to-make-alpha-videos">How to make alpha videos</h1>

<p>The method we describe uses the open source tools Blender and ffmpeg:</p>

<ol>
  <li>Film your subject in front of a single colour background such as a bright
green curtain.</li>
  <li>Process the video to build an array of PNG still images with transparency
data.</li>
  <li>Encode to a video format (in this case, WebM).</li>
</ol>

<p>There are
also proprietary tools to do the same job, such as <a href="http://www.adobe.com/products/aftereffects.html">Adobe After
Effects</a>, which you may find
simpler.</p>

<h3 id="make-a-green-screen-video">1. Make a green screen video</h3>

<p>First of all, you need to film your subject in a way that everything in the
background can be ‘removed’ (made transparent) by subsequent processing.</p>

<p>The easiest way to do this is to film in front of a single colour background,
such as a screen or curtain. Green or blue are the colors most often used, mostly because of their difference from skin tones.</p>

<p>There are <a href="http://www.youtube.com/watch?v=M_WdLkaOUic">several</a> <a href="https://en.wikipedia.org/wiki/Chroma_key#Process">guides</a> <a href="http://www.youtube.com/watch?v=q3PZO_lCBkw">online</a> to filming green screen video (also known as
chroma key) and <a href="https://www.google.com/search?tbm=shop&amp;q=chromakey">lots of
places</a> to buy green and
blue screen backdrops. Alternatively, you can paint a background with <a href="https://www.google.com/search?tbm=shop&amp;q=chroma+key+paint">chroma
key paint</a>.</p>

<p><a href="http://vimeo.com/68451324">The Great Gatsby VFX reel</a> shows just how much can be accomplished with green screen.</p>

<p>Some tips for filming:</p>

<ul>
  <li>Ensure your subject does not have clothes or objects that are the same color
as the backdrop, otherwise these will show up as ‘holes’ in the final video. Even small logos or jewelry can be problematic.</li>
  <li>Use consistent, even lighting, and avoid shadows: the aim is to have the
smallest possible range of colors in the background that will subsequently
need to be made transparent.</li>
  <li>Using multiple diffused lights helps to avoid shadows and background color
variations.</li>
  <li>Avoid shiny backgrounds: matte surfaces diffuse light better.</li>
</ul>

<h3 id="create-raw-alpha-video-from-green-screen-video">2. Create raw alpha video from green screen video</h3>

<p>The following steps describe one way to create a raw alpha video from green screen videos:</p>

<ol>
  <li>Once you’ve shot a green screen video, you can use an open source tool like <a href="http://www.blender.org/download/get-blender">Blender</a> to convert the video
to an array of PNG files with alpha data. Use Blender’s color keying to
remove the green screen and make it transparent. (Note that PNG is not
compulsory: any format that preserves alpha channel data is fine.)</li>
  <li>Convert the array of PNG files to a raw YUVA video using an open source tool
such as ffmpeg:
<br />
<code>ffmpeg -i image%04d.png -pix_fmt yuva420p video.raw</code><br />
<br />
Alternatively encode the files directly to WebM, using an ffmpeg command
like this:
<br />
  <code>ffmpeg -i image%04d.png output.webm</code></li>
</ol>

<p>If you want to add audio, you can use ffmpeg to mux that in with a command like
this:</p>

<p><code>ffmpeg -i image%04d.png -i audio.wav output.webm</code></p>

<h3 id="encode-alpha-video-to-webm">3. Encode alpha video to WebM</h3>

<p>Raw alpha videos can be encoded to WebM in two ways.</p>

<ol>
  <li>
    <p>With ffmpeg: we added support to ffmpeg to encode WebM alpha videos.<br />
<br />
Use ffmpeg with an input video including alpha data, set the output format to
WebM, and encoding will automatically be done in the correct format as per
the spec. (Note: you’ll currently need to make sure to get <a href="https://github.com/FFmpeg/FFmpeg">the latest
version of ffmpeg from the git tree</a> for
this to work.)<br />
<br />
Sample command:
<br />
<code>ffmpeg -i myAlphaVideo.webm output.webm</code></p>
  </li>
  <li>
    <p>Using webm-tools:
<br />
<code>git clone http://git.chromium.org/webm/libvpx.git</code><br />
<br />
webm-tools is a set of simple open source tools related to WebM, maintained by the WebM Project authors, including a tool for creating WebM videos with alpha transparency.<br />
<br />
Run the binary with <code>--help</code> to see list of options supported by alpha_encoder.</p>
  </li>
</ol>

<h3 id="playback-in-chrome">4. Playback in Chrome</h3>

<p>To play the encoded WebM file in Chrome, simply set the file as the source of a
video element. <br />
<br />
As of now, VP8 alpha playback is behind a flag, so you have to either enable it
in about:flags or <a href="http://www.chromium.org/developers/how-tos/run-chromium-with-flags">set the command line
flag</a>
<code>--enable-vp8-alpha-playback</code> when you start Chrome. When the flag is enabled,
alpha playback also works with
<a href="http://updates.html5rocks.com/2011/11/Stream-video-using-the-MediaSource-API">MediaSource</a>.</p>

<h3 id="how-did-they-do-it">How did they do it?</h3>

<p>We talked to Google engineer Vignesh Venkatasubramanian about his work on the
project. He summarised the key challenges involved:</p>

<ul>
  <li>The VP8 bitstream had no support for alpha channel. So we had to incorporate
alpha without breaking the VP8 bitstream and without breaking existing
players.</li>
  <li>Chrome’s renderer was not capable of rendering videos with alpha.</li>
  <li>Chrome has multiple rendering paths for multiple hardware/GPU devices. Every
rendering path had to be changed to support rendering of alpha videos.</li>
</ul>

<p>We can think of lots of interesting use cases for video alpha transparency:
games, interactive videos, collaborative story telling (add your own video to a
background video/image), videos with alternative characters or plots, web apps
that use overlay video components…</p>

<p>Happy film making! Let us know if you build something amazing with alpha transparency.</p>

  </section>
  <section>
    <!-- TODO: Update link. -->
    
      <a href="/tag/video" class="tag">video</a>
    
      <a href="/tag/webm" class="tag">webm</a>
    
  </section>
  <div class="pager">
    
    <a href="/2013/06/sourceMappingURL-and-sourceURL-syntax-changed">&laquo; sourceMappingURL and sourceURL syntax changed</a>
     | 
    <a href="/2013/09/dialog-element-Modals-made-easy">dialog element: Modals made easy &raquo;</a>
    
  </div>
</div>
</article>
<section class="disqus pattern-bg-lighter">
  <div id="disqus" class="container">
    <h2>Comments</h2>
    <div id="disqus_thread">
      <a href="#disqus_thread" class="load-comments"
          data-disqus-identifier="/2013/07/Alpha-transparency-in-Chrome-video">0</a>
    </div>
  </div>

  <noscript>
    <p class="center">
      <strong>
        <a href="http://disqus.com/?ref_noscript">Please enable JavaScript to view the comments powered by Disqus.</a>
      </strong>
    </p>
  </noscript>

  <script>

    var disqus_shortname = 'html5rocks';
    var disqus_identifier = 'http://updates.html5rocks.com/2013/07/Alpha-transparency-in-Chrome-video';
    var disqus_url = 'http://updates.html5rocks.com/2013/07/Alpha-transparency-in-Chrome-video';
    var disqus_developer = 0;

    var disqus_config = function () {
      var funky_language_code_mapping = {
        'de': 'de_inf',
        'es': 'es_ES',
        'pt': 'pt_EU',
        'sr': 'sr_CYRL',
        'sv': 'sv_SE',
        'zh': 'zh_HANT'
      };
      this.language = funky_language_code_mapping['en'] ||
                      'en';

      this.callbacks.onReady = [ function () {
                                    try {
                                      ga('send', 'event', 'View comments');
                                    } catch(err){}
                                 } ];
      this.callbacks.onNewComment = [ function (comment) {
                                        try {
                                          ga('send', 'event', 'Commented');
                                        } catch(err){}
                                      } ];
    };

    window.addEventListener('load', function(e) {

      var c = document.createElement('script');
      c.type = 'text/javascript';
      c.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      c.async = true;

      var s = document.getElementsByTagName('script')[0], sp = s.parentNode;
      sp.insertBefore(c, s);

      if (window.location.hash === '#disqus_thread')
        loadComments();

    }, false);

    var disqus_loaded = false;
    function loadComments() {

      if (disqus_loaded)
        return;

      disqus_loaded = true;

      ga('send', 'event', 'Interactions', 'Comments', 'Comments Loaded');

      var s = document.getElementsByTagName('script')[0], sp = s.parentNode;
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;

      var disqusContainer = document.getElementById('disqus');
      disqusContainer.classList.add('active');

      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      sp.insertBefore(dsq, s);
    }
    var loadCommentsButtons = document.querySelectorAll('.load-comments');
    for(var l = 0; l < loadCommentsButtons.length; l++)
      loadCommentsButtons[l].addEventListener('click', loadComments);

  </script>
</section>



    </div>
    <footer>
  <div class="container">
    
    <h1>Next steps</h1>
    <aside class="panel share">
      <h2>Share</h2>
        <a href="https://twitter.com/share?url=http://www.html5rocks.com/tutorials/shapes/getting-started/&amp;text=Getting Started with CSS Shapes&amp;lang=en&amp;via=ChromiumDev&amp;related=ChromiumDev" class="twitter" target="_blank">Twitter</a>
        <a href="https://www.facebook.com/sharer/sharer.php?u=http://www.html5rocks.com/tutorials/shapes/getting-started/" class="facebook" target="_blank">Facebook</a>
        <a href="https://plus.google.com/share?url=http://www.html5rocks.com/tutorials/shapes/getting-started/" class="gplus" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">Google+</a>
    </aside>
    <aside class="panel rss">
      <h2>Subscribe</h2>
      <p>Enjoyed this article? Grab the <a href="http://feeds.feedburner.com/html5rocks">RSS feed</a> and stay up-to-date.</p>
    </aside>
    
    <p class="licensing">
      Except as otherwise <a href="http://code.google.com/policies.html#restrictions">noted</a>, the content of this page is licensed under the <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 License</a>, and code samples are licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>.
    </p>
  </div>
</footer>


    <script>
      (function() {

        var siteHeader = document.getElementById('siteheader');
        var navToggle = document.getElementById('navtoggle');
        var siteNav = document.getElementById('sitenav');

        navToggle.addEventListener('click', function(e) {
          siteNav.classList.toggle('active');
          e.preventDefault();
        });

      })();
    </script>

    <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create','UA-15028909-7','auto');
      ga('create','UA-49880327-4','auto',{'name':'html5rocks'});
      ga('send','pageview');
      ga('html5rocks.send','pageview');
    </script>
  </body>
</html>
