<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta property="twitter:account_id" content="1593210261" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="A resource for developers looking to put HTML5 to use today, including information on specific features and when to use them in your apps.">
<meta name="keywords" content="html5,html 5,html5 demos,html5 examples,javascript,css3,notifications,geolocation,web workers,apppcache,file api,filereader,indexeddb,offline,audio,video,drag and drop,chrome,sse,mobile">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Web Audio Changes in m36</title>

<!-- Add to homescreen for Chrome on Android -->
<meta name="mobile-web-app-capable" content="yes">
<link rel="icon" sizes="192x192" href="  /assets/HTML5_Badge_192-f9389f6cad587f357d82be791970c8ad.png">

<!-- Add to homescreen for Safari on iOS -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="HTML5 Rocks">
<link rel="apple-touch-icon-precomposed" href="/assets/HTML5_Badge_192-f9389f6cad587f357d82be791970c8ad.png
">

<!-- Tile icon for Win8 (144x144 + tile color) -->
<meta name="msapplication-TileImage" content="/assets/HTML5_Badge_144-ddcf1cea1a1204b1733041733d66f76a.png
">
<meta name="msapplication-TileColor" content="#3372DF">

<!-- TODO: consider rel=canonical -->
<!-- TODO: consider rel=publisher -->
<link rel="alternate" type="application/rss+xml" title="HTML5 Rocks RSS" href="http://feeds.feedburner.com/html5rocks">
<link rel="publisher" href="https://plus.google.com/+GoogleChromeDevelopers">




  




<link href="//fonts.googleapis.com/css?family=Open+Sans:600,800|Source+Code+Pro" rel="stylesheet">
<link rel="stylesheet" href="/assets/main-8dae1b06ec239bb8b24c3d98cd1ad04b.css">

<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5-els.js"></script>
<![endif]-->

  </head>
  <body>
    <header class="main" id="siteheader">
  <a href="#sitenav" id="navtoggle"></a>
  <nav id="sitenav" class="container">
    <ul>
      <li id="tutorials_menu">
        <a href="http://www.html5rocks.com" class="tutorials">Home</a>
      </li>
      <li id="tutorials_menu">
        <a href="http://www.html5rocks.com/en/tutorials/?page=1" class="tutorials">Tutorials</a>
      </li>
      <li id="updates_menu">
        <a href="http://www.html5rocks.com/en/updates" class="updates">Updates</a>
      </li>
      <li id="contrib_menu">
        <a href="https://github.com/html5rocks/www.html5rocks.com/blob/master/CONTRIBUTING.md" target="_blank">Contribute</a>
      </li>
      <li id="slides_menu">
        <a href="http://www.html5rocks.com/en/slides" class="slides">Slides</a>
      </li>
      <li id="resources_menu">
        <a href="http://www.html5rocks.com/en/resources" class="resources">Resources</a>
      </li>
    </ul>
  </nav>
</header>

    <div class="body-content">
      <section class="banner">
        <section class="container">
          <a href="/en/" class="watermark"></a>
          <h1>Web Audio Changes in m36</h1>
          
        </section>
      </section>
      <article class="content-wrapper article">
<div class="container">
  <section class="byline clearfix">
    <section class="author-images">
      
        
<!-- TODO: change image address.-->

<img src="http://www.html5rocks.com/static/images/profiles/chriswilson.png"
     alt="Chris Wilson"
     title="Chris Wilson"
     width="60" height="60"
     class="avatar">



      
    </section>
    <section class="meta">
      <div class="authors">
          
    
    <!-- TODO: change link. -->
    <strong>By</strong> <a href="http://www.html5rocks.com/profiles/#chriswilson">
      Chris Wilson
    </a> 
  

      </div>
      <div class="published">
        <time pubdate=""><strong>Published:</strong> July 25, 2014</time>
      </div>
      <div class="updated">
        <time><strong>Updated:</strong> July 25, 2014</time>
      </div>
      <div class="comments">
        <span><strong>Comments:</strong> <a href="#disqus_thread" class="load-comments" data-disqus-identifier="http://html5rocks.com/updates//2014/07/Web-Audio-Changes-in-m36"></a></span>
      </div>
      <div id="notcompatible" class="hidden">
        Your browser may not support the functionality in this article.
      </div>
    </section>
  </section>
  <section class="content">
    <h2 id="web-audio-changes">Web Audio changes</h2>

<p>At Google, we love standards.  We’re on a mission to build out the standards-defined Web platform.  One of the small warts on that for some time has been the webkit- prefixed implementation of the Web Audio API (notably the webkitAudioContext object), and some of the deprecated bits of Web Audio that we’ve continued to support.</p>

<p>It was originally planned that m36 would remove support for the prefixed webkitAudioContext, since we had begun supporting the unprefixed AudioContext object. This turned out to be more troublesome than expected, so m36 supports both unprefixed and prefixed - however, even in the reintroduced webkitAudioContext, several legacy methods and attributes like createGainNode and createJavaScriptNode have been removed. In short, in m36 webkitAudioContext and AudioContext are aliases of each other; there is no difference in functionality between the two.</p>

<p>We will remove the support for the prefix completely after m36, likely in a couple of releases. We’ll make an announcement here when the change is imminent, and we are continuing to reach out to authors to fix their Web Audio applications.</p>

<p>Why have we done this, rather than reverting to the previous implementation?  Well, in part, we’ve been reticent to move too far backwards; we’ve already removed those APIs, and as a nice side-effect to this aliasing, applications can then work nicely on Firefox, which has never supported a prefixed AudioContext object (and quite right, too!) in their Web Audio support initially released last fall.</p>

<p>The rest of this update provides a guide to fixing things that may be broken in your code due to this change.  The great thing about fixing these problems is that your code is then quite likely to just work in Firefox, too!  (I’d thought for a long time that my Vocoder application was broken due to Firefox’s implementation, but it turned out to be one of these problems!)</p>

<p>If you just want to get up and running, you may want to take a look at a <a href="http://en.wikipedia.org/wiki/Monkey_patch">monkey-patch</a> <a href="https://github.com/cwilso/webkitAudioContext-MonkeyPatch">library I wrote for applications that were written to the old Web Audio code</a> - this can help you get up and running in a minimum amount of time, as it will alias the objects and methods appropriately.  Indeed, the patches the library lists is a good guide to the things that have changed.</p>

<h2 id="first-and-foremost">First and foremost:</h2>
<p>Any references to <code>window.webkitAudioContext</code> should be made to <code>window.AudioContext</code> instead.  Frequently, this has been fixed with a simple:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">window</span><span class="p">.</span><span class="nx">AudioContext</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">AudioContext</span> <span class="o">||</span> <span class="nb">window</span><span class="p">.</span><span class="nx">webkitAudioContext</span><span class="p">;</span></code></pre></div>

<p>If your app is responding with something like “Unfortunately, your browser does not support Web Audio.  Please use Chrome or Safari.” - it’s quite likely explicitly looking for <code>webkitAudioContext</code>.  Bad developer!  You could have been supporting Firefox for months!</p>

<p>But there are a few other, more subtle code removals, some of which can be less obvious.</p>

<ul>
  <li>The BiquadFilter enumerated type constants for the <code>.type</code> attribute (which is now a string) no longer appear on the <code>BiquadFilterNode</code> object, and we do not support them on the <code>.type</code> attribute.  So you don’t use <code>.LOWPASS</code> (or 0) anymore - you set it to “lowpass”.</li>
  <li>Also, the <code>Oscillator.type</code> attribute is similarly now a string enumerated type - no more <code>.SAWTOOTH</code>.</li>
  <li><code>PannerNode.type</code> is also now a string enumerated type.</li>
  <li><code>PannerNode.distanceModel</code> is also now a string enumerated type.</li>
  <li><code>createGainNode</code> was renamed to <code>createGain</code></li>
  <li><code>createDelayNode</code> was renamed to <code>createDelay</code></li>
  <li><code>createJavaScriptNode</code> was renamed to <code>createScriptProcessor</code></li>
  <li><code>AudioBufferSourceNode.noteOn()</code> is now replaced by <code>start()</code></li>
  <li><code>AudioBufferSourceNode.noteGrainOn()</code> is also now replaced by <code>start()</code></li>
  <li><code>AudioBufferSourceNode.noteOff()</code> is renamed to <code>stop()</code></li>
  <li><code>OscillatorNode.noteOn()</code> is renamed to <code>start()</code></li>
  <li><code>OscillatorNode.noteOff()</code> is renamed to <code>stop()</code></li>
  <li><code>AudioParam.setTargetValueAtTime()</code> is renamed to <code>setTargetAtTime()</code></li>
  <li><code>AudioContext.createWaveTable()</code> and <code>OscillatorNode.setWaveTable()</code> are now renamed <code>createPeriodicWave() and </code>setPeriodicWave()`.</li>
  <li><code>AudioBufferSourceNode.looping</code> was removed, in favor of <code>.loop</code></li>
  <li><code>AudioContext.createBuffer(ArrayBuffer, boolean)</code> to synchronously decode a blob of encoded audio  data has been removed.  Synchronous calls that take a long time to complete are poor coding practice; use the asynchronous decodeAudioData call instead.  This is one of the more challenging changes - you need to actually change logic flow - but a far better practice.  Mozilla’s Ehsan Angkari wrote a nice <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Porting_webkitAudioContext_code_to_standards_based_AudioContext#Removal_of_the_synchronous_AudioContext.createBuffer_method">example</a> of how to do this in <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Porting_webkitAudioContext_code_to_standards_based_AudioContext">their post on converting to standard Web Audio</a>.</li>
</ul>

<p>Many of these (like the renaming of createGainNode, and the removal of the synchronous decoding in createBuffer) will obviously show up in the developer tools console as an error - however, some others, like this usage:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">myFilterNode</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">myFilterNode</span><span class="p">.</span><span class="nx">BANDPASS</span><span class="p">;</span></code></pre></div>

<p>will not show up at all, and silently fail (myFilterNode.BANDPASS will now resolve to undefined, and the attempt to set .type to undefined will simply fail to produce any effect. This, by the way, was what was causing the vocoder to fail.)  Likewise, just assigning the filter.type to a number used to work:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">myFilterNode</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span></code></pre></div>

<p>But now, you need to use the string enumeration:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">myFilterNode</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="err">“</span><span class="nx">bandpass</span><span class="err">”</span><span class="p">;</span></code></pre></div>

<p>So, you may wish to grep your code for the following terms:</p>

<ul>
  <li><code>webkitAudioContext</code></li>
  <li><code>.LOWPASS</code></li>
  <li><code>.HIGHPASS</code></li>
  <li><code>.BANDPASS</code></li>
  <li><code>.LOWSHELF</code></li>
  <li><code>.HIGHSHELF</code></li>
  <li><code>.PEAKING</code></li>
  <li><code>.NOTCH</code></li>
  <li><code>.ALLPASS</code></li>
  <li><code>.SINE</code></li>
  <li><code>.SQUARE</code></li>
  <li><code>.SAWTOOTH</code></li>
  <li><code>.TRIANGLE</code></li>
  <li><code>.noteOn</code></li>
  <li><code>.noteGrainOn</code></li>
  <li><code>.noteOff</code></li>
  <li><code>.setWaveTable</code></li>
  <li><code>.createWaveTable</code></li>
  <li><code>.looping</code></li>
  <li><code>.EQUALPOWER</code></li>
  <li><code>.HRTF</code></li>
  <li><code>.LINEAR</code></li>
  <li><code>.INVERSE</code></li>
  <li><code>.EXPONENTIAL</code></li>
  <li><code>createGainNode</code></li>
  <li><code>createDelayNode</code></li>
  <li><code>.type</code> (yes, this will have lots of false positives - but it’s the only way to catch the last example above!)</li>
</ul>

<p>Once more, if you’re in a hurry and want to get up and running, just grab a copy of <a href="https://github.com/cwilso/webkitAudioContext-MonkeyPatch">my monkeypatch webkitAudioContext library</a> and include it in your application.  Happy Audio Hacking!</p>

  </section>
  <section>
    <!-- TODO: Update link. -->
    
      <a href="/tag/webaudio" class="tag">webaudio</a>
    
  </section>
  <div class="pager">
    
    <a href="/2014/07/dialog-element-shipped-in-Chrome-37-Beta">&laquo; dialog element: shipped in Chrome 37 Beta</a>
     | 
    <a href="/2014/08/Collecting-and-Iterating-the-ES6-Way">Collecting and Iterating, the ES6 Way &raquo;</a>
    
  </div>
</div>
</article>
<section class="disqus pattern-bg-lighter">
  <div id="disqus" class="container">
    <h2>Comments</h2>
    <div id="disqus_thread">
      <a href="#disqus_thread" class="load-comments"
          data-disqus-identifier="/2014/07/Web-Audio-Changes-in-m36">0</a>
    </div>
  </div>

  <noscript>
    <p class="center">
      <strong>
        <a href="http://disqus.com/?ref_noscript">Please enable JavaScript to view the comments powered by Disqus.</a>
      </strong>
    </p>
  </noscript>

  <script>

    var disqus_shortname = 'html5rocks';
    var disqus_identifier = 'http://html5rocks.com/updates//2014/07/Web-Audio-Changes-in-m36';
    var disqus_url = 'http://html5rocks.com/updates//2014/07/Web-Audio-Changes-in-m36';
    var disqus_developer = 0;

    var disqus_config = function () {
      var funky_language_code_mapping = {
        'de': 'de_inf',
        'es': 'es_ES',
        'pt': 'pt_EU',
        'sr': 'sr_CYRL',
        'sv': 'sv_SE',
        'zh': 'zh_HANT'
      };
      this.language = funky_language_code_mapping['en'] ||
                      'en';

      this.callbacks.onReady = [ function () {
                                    try {
                                      ga('send', 'event', 'View comments');
                                    } catch(err){}
                                 } ];
      this.callbacks.onNewComment = [ function (comment) {
                                        try {
                                          ga('send', 'event', 'Commented');
                                        } catch(err){}
                                      } ];
    };

    window.addEventListener('load', function(e) {

      var c = document.createElement('script');
      c.type = 'text/javascript';
      c.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      c.async = true;

      var s = document.getElementsByTagName('script')[0], sp = s.parentNode;
      sp.insertBefore(c, s);

      if (window.location.hash === '#disqus_thread')
        loadComments();

    }, false);

    var disqus_loaded = false;
    function loadComments() {

      if (disqus_loaded)
        return;

      disqus_loaded = true;

      ga('send', 'event', 'Interactions', 'Comments', 'Comments Loaded');

      var s = document.getElementsByTagName('script')[0], sp = s.parentNode;
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;

      var disqusContainer = document.getElementById('disqus');
      disqusContainer.classList.add('active');

      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      sp.insertBefore(dsq, s);
    }
    var loadCommentsButtons = document.querySelectorAll('.load-comments');
    for(var l = 0; l < loadCommentsButtons.length; l++)
      loadCommentsButtons[l].addEventListener('click', loadComments);

  </script>
</section>



    </div>
    <footer>
  <div class="container">
    
    <h1>Next steps</h1>
    <aside class="panel share">
      <h2>Share</h2>
        <a href="https://twitter.com/share?url=http://www.html5rocks.com/tutorials/shapes/getting-started/&amp;text=Getting Started with CSS Shapes&amp;lang=en&amp;via=ChromiumDev&amp;related=ChromiumDev" class="twitter" target="_blank">Twitter</a>
        <a href="https://www.facebook.com/sharer/sharer.php?u=http://www.html5rocks.com/tutorials/shapes/getting-started/" class="facebook" target="_blank">Facebook</a>
        <a href="https://plus.google.com/share?url=http://www.html5rocks.com/tutorials/shapes/getting-started/" class="gplus" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">Google+</a>
    </aside>
    <aside class="panel rss">
      <h2>Subscribe</h2>
      <p>Enjoyed this article? Grab the <a href="http://feeds.feedburner.com/html5rocks">RSS feed</a> and stay up-to-date.</p>
    </aside>
    
    <p class="licensing">
      Except as otherwise <a href="http://code.google.com/policies.html#restrictions">noted</a>, the content of this page is licensed under the <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 License</a>, and code samples are licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>.
    </p>
  </div>
</footer>


    <script>
      (function() {

        var siteHeader = document.getElementById('siteheader');
        var navToggle = document.getElementById('navtoggle');
        var siteNav = document.getElementById('sitenav');

        navToggle.addEventListener('click', function(e) {
          siteNav.classList.toggle('active');
          e.preventDefault();
        });

      })();
    </script>

    <!-- TODO: change UA-XXXXX-X -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-XXXXX-X', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
